#!/usr/bin/env python

import scanner
from termcolor import colored
import optparse

def get_arguments():
      parser = optparse.OptionParser()
      parser.add_option("-u", "--url", dest="url", help=colored("URL address", "green"))
      parser.add_option("-i", "--ignore", dest="ignore", help=colored("Links to ignore address\n Example: http://10.0.0.2/dvwa/logout.php", "green"))
      (options, arguments) = parser.parse_args()
      if not options.url:
         parser.error(colored("\n[-] Please specify URL, use --help for more info.", "red"))
      elif not options.ignore:
         parser.error(colored("\n[-] Please specify ignore address, use --help for mor info.", "red"))
      return options
def with_login_scanning_progress():
    vuln_scanner = scanner.Scanner(target_url, links_to_ignore)
    vuln_scanner.session.post(login_page_url, data=data_dict)
    vuln_scanner.crawl()
    vuln_scanner.run_scanner()
def normal_scanning_progress():
    vuln_scanner = scanner.Scanner(target_url, links_to_ignore)
    vuln_scanner.crawl()
    vuln_scanner.run_scanner()

options = get_arguments()

target_url = options.url
links_to_ignore = [options.ignore]

login_page_checker = input(colored("Does your website has a login page? (Y/N) ", "yellow"))


if login_page_checker == "Y":
    print(colored("First you need to change [data_dict] is under the vulnerability_scanner.py. After start this program again.\nIf you are already done this, just ignore this message.", "red"))
    login_page_url = input(colored("\nPlease write login page URL: ", "yellow"))
    data_dict = {"username": "admin", "password": "password", "Login": "submit"} # Please Change the data_dict if you want to scan websites.
    with_login_scanning_progress()

elif login_page_checker == "N":
    print(colored("[+] Program is starting ....", "green"))
    normal_scanning_progress()

else:
    print(colored("[-] Please write the correct word. (Y/N)\n Program is closing....", "red"))
    exit()

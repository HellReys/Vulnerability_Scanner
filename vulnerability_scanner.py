#!/usr/bin/env python

import scanner
import optparse

def get_arguments():
      parser = optparse.OptionParser()
      parser.add_option("-u", "--url", dest="url", help="URL address")
      parser.add_option("-i", "--ignore", dest="ignore", help="Links to ignore address\n Example: http://10.0.0.2/dvwa/logout.php")
      (options, arguments) = parser.parse_args()
      if not options.url:
         parser.error("\n[-] Please specify URL, use --help for more info.")
      elif not options.ignore:
         parser.error("\n[-] Please specify ignore address, use --help for mor info.")
      return options

options = get_arguments()

target_url = options.url
links_to_ignore = [options.ignore]

data_dict = {"username": "admin", "password": "password", "Login": "submit"} # Please Change the data_dict if you want to scan any websites.

vuln_scanner = scanner.Scanner(target_url, links_to_ignore)
vuln_scanner.session.post("http://10.0.2.5/dvwa/login.php/", data=data_dict)

vuln_scanner.crawl()
vuln_scanner.run_scanner()